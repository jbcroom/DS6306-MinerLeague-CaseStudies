---
title: "Case_Study_1 Update"
author: "Sandesh Ojha"
date: "June 19, 2019"
output: 
  html_document:
    keep_md: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r message=FALSE, warning=FALSE}
#install necessary libraries
library(dplyr)
library(ggplot2)

#Setup the environment for working
WorkingDirPath = "C:/Users/sojha.WVOFFICE.000/Documents/SMU/Summer 2019/Doing Data Science/CaseStudy1_2_2_2"
setwd(WorkingDirPath)
beerFile = "Beers.csv"
breweryFile = "Breweries.csv"

#Read the files into dataframes
beerDF = read.csv(beerFile)
breweryDF = read.csv(breweryFile)
```

####Question 1 : How many breweries are present in each state?
```{r, fig.width=10, fig.height=10,message=FALSE, warning=FALSE}
#Counting the number of breweries by state
brewerysByState = breweryDF %>% count(State,sort=TRUE)
names(brewerysByState) = c("State", "Count")
print(brewerysByState,n=51)


#Ploting the number of breweries in each state to provide a visual output
ggplot(data=brewerysByState, aes(x=reorder(State,Count), y=Count, fill=State)) + geom_bar(stat="identity", show.legend = FALSE) + labs(x ="State",y="Brewery Count",title="Number of Breweries by State") + theme(plot.title = element_text(size = 16,face= "bold",hjust = 0.5)) + theme(axis.text = element_text(size=8),axis.title=element_text(size=10))
```

####Question 2 : Merge beer data with the breweries data.  Print the first 6 observations and the last six observations to check the merged file.
```{r message=FALSE, warning=FALSE}
#Merging the beer and breweries data into a new data frame
BeersAndBreweriesDF = merge(x=beerDF,y=breweryDF,by.x="Brewery_id",by.y="Brew_ID")
head(BeersAndBreweriesDF,6)
tail(BeersAndBreweriesDF,6)

#Cleanup the names of the columns to make the data more understandable
names(BeersAndBreweriesDF) = c("Brewery_id","Beer_Name","Beer_ID","ABV","IBU","Beer_Style","Beer_OZ","Brewery_Name","Brewery_City","Brewery_State")
```

####Question 3 : Report the number of NA's in each column.
```{r}
sapply(BeersAndBreweriesDF, function(x) sum(is.na(x)))
```

####Question 4 : Compute the median alcohol content and international bitterness unit for each state.  Plot a bar chart to compare.
```{r, fig.width=10, fig.height=10,message=FALSE, warning=FALSE}
#Calculating the median ABV and median IBV by state. Ignoring missing values
ABVByState = BeersAndBreweriesDF %>% group_by(Brewery_State) %>% summarise(median=median(ABV,na.rm=TRUE))
IBUByState = BeersAndBreweriesDF %>% group_by(Brewery_State) %>% summarise(median=median(IBU,na.rm=TRUE))

#Cleanup the dataframe names
names(ABVByState) = c("State","MedianABV")
names(IBUByState) = c("State","MedianIBU")



#Bar charts for comparison
#ABVByState
 ggplot(data=ABVByState, aes(x=reorder(State,MedianABV), y=MedianABV, fill=State)) + geom_bar(stat="identity", show.legend = FALSE) + labs(x ="State",y="ABV",title="ABV by State") + theme(plot.title = element_text(size = 16,face= "bold",hjust = 0.5)) + theme(axis.text = element_text(size=8),axis.title=element_text(size=10))
 
#IBUByState
  ggplot(data=IBUByState, aes(x=reorder(State,MedianIBU), y=MedianIBU, fill=State)) + geom_bar(stat="identity", show.legend = FALSE) + labs(x ="State",y="IBU",title="IBU by State") + theme(plot.title = element_text(size = 16,face= "bold",hjust = 0.5)) + theme(axis.text = element_text(size=8),axis.title=element_text(size=10))
```


####Question 5 : Which state has the maximum alcoholic(ABV) beer? Which state has the most bitter (IBU) beer ?

```{r, fig.width=10, fig.height=10}
 #Filter the data to get the single row with maximum ABV
 maxABVStateDF = BeersAndBreweriesDF %>% filter(ABV == max(ABV,na.rm=TRUE))
 
 #Put just the Brewery State in a vector
 maxABVState = maxABVStateDF$Brewery_State[1]
 as.character(maxABVState)
 
 
 #Filter the data to get the single row with maximum IBU
 maxIBUStateDF = BeersAndBreweriesDF %>% filter(IBU ==   max(IBU,na.rm=TRUE))
 
 #Put just the Brewery State in a vector
 maxIBUState = maxIBUStateDF$Brewery_State[1]
 as.character(maxIBUState)
```

####Question 6 : Summary Statistics for the ABV variable.
```{r}
 #summary statistics for the ABV variable
 summary(BeersAndBreweriesDF$ABV)
```

####Question 7 : Is there an apparent relationship between the bitterness of the beer and it's alcholic content? Draw a scatter plot.

```{r, fig.width=10, fig.height=10}
#Scatter plot of bitterness (IBU) and alcoholic content (ABV)
ggplot(BeersAndBreweriesDF, aes(x=ABV, y=IBU)) + geom_point()
```
 
Github - https://github.com/jbcroom/DS6306-MinerLeague-CaseStudies
 