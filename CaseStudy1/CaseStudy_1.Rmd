---
title: "Case_Study_1"
author: "Brandon Croom"
date: "June 16, 2019"
output: 
  html_document:
    keep_md: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
#install necessary libraries
library(dplyr)
library(ggplot2)

#Setup the environment for working
WorkingDirPath = "C:\\Users\\croomb\\OneDrive - BAT\\Desktop\\Personal Training\\SMU\\DS 6306 - Doing Data Science\\DS6306-MinerLeague-CaseStudies\\CaseStudy1"
setwd(WorkingDirPath)
beerFile = ".\\Data\\Beers.csv"
breweryFile = ".\\Data\\Breweries.csv"

#Read the files into dataframes
beerDF = read.csv(beerFile)
breweryDF = read.csv(breweryFile)

#Question 1
#Count the number of breweries by state
 brewerysByState = breweryDF %>% count(State,sort=TRUE)
 names(brewerysByState) = c("State", "Count")

#Plot the number of breweries in each state to provide output for questions
 ggplot(data=brewerysByState, aes(x=reorder(State,Count), y=Count, fill=State)) + geom_bar(stat="identity", show.legend = FALSE) + labs(x ="State",y="Brewery Count",title="Number of Breweries by State") + coord_flip() + theme(plot.title = element_text(hjust = 0.5))
 
 #Question 2
 #Merge the beer and breweries data into a new data frame
 BeersAndBreweriesDF = merge(x=beerDF,y=breweryDF,by.x="Brewery_id",by.y="Brew_ID")
 
 #Cleanup the names of the columns to make the data more understandable
 names(BeersAndBreweriesDF) = c("Brewery_id","Beer_Name","Beer_ID","ABV","IBU","Beer_Style","Beer_OZ","Brewery_Name","Brewery_City","Brewery_State")
 
 #Question 3
 #Count the number of NAs in the data set
 sapply(BeersAndBreweriesDF, function(x) sum(is.na(x)))
 
 #Question 4
 #Calculate the median ABV and median IBV by state. Ignore missing values
ABVByState = BeersAndBreweriesDF %>% group_by(Brewery_State) %>% summarise(median=median(ABV,na.rm=TRUE))

IBUByState = BeersAndBreweriesDF %>% group_by(Brewery_State) %>% summarise(median=median(IBU,na.rm=TRUE))

#Cleanup the dataframe names
names(ABVByState) = c("State","MedianABV")
names(IBUByState) = c("State","MedianIBU")

#Bar charts for comparison
#ABVByState
 ggplot(data=ABVByState, aes(x=reorder(State,MedianABV), y=MedianABV, fill=State)) + geom_bar(stat="identity", show.legend = FALSE) + labs(x ="State",y="ABV",title="ABV by State") + coord_flip() + theme(plot.title = element_text(hjust = 0.5))
 
#IBUByState
  ggplot(data=IBUByState, aes(x=reorder(State,MedianIBU), y=MedianIBU, fill=State)) + geom_bar(stat="identity", show.legend = FALSE) + labs(x ="State",y="IBU",title="IBU by State") + coord_flip() + theme(plot.title = element_text(hjust = 0.5))
 
 #Question 5
 #Filter the data to get the single row with maximum ABV
 maxABVStateDF = BeersAndBreweriesDF %>% filter(ABV == max(ABV,na.rm=TRUE))
 
 #Put just the Brewery State in a vector
 maxABVState = maxABVStateDF$Brewery_State[1]
 as.character(maxABVState)
 
 
 #Filter the data to get the single row with maximum IBU
 maxIBUStateDF = BeersAndBreweriesDF %>% filter(IBU ==   max(IBU,na.rm=TRUE))
 
 #Put just the Brewery State in a vector
 maxIBUState = maxIBUStateDF$Brewery_State[1]
 as.character(maxIBUState)
  
 #Question 6
 #summary statistics for the ABV variable
 summary(BeersAndBreweriesDF$ABV)
 
 #Question 7
 #Scatter plot of bitterness (IBU) and alcoholic content (ABV)
 ggplot(BeersAndBreweriesDF, aes(x=ABV, y=IBU)) + geom_point()
 